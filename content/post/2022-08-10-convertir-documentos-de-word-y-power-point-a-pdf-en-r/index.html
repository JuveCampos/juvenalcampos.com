---
title: Convertir documentos de Word y Power Point a PDF en R
author: Juvenal Campos
date: '2022-08-10'
slug: convertir-documentos-de-word-y-power-point-a-pdf-en-r
categories:
  - Tutoriales
tags: []
---



<div id="r-cuenta-con-librerías-capaces-de-ayudarnos-a-convertir-archivos-de-office-a-pdf-los-cuales-pueden-ayudarnos-cuando-el-guardar-como-nos-queda-corto." class="section level2">
<h2>R cuenta con librerías capaces de ayudarnos a convertir archivos de Office a PDF, los cuales pueden ayudarnos cuando el <em>Guardar como…</em> nos queda corto.</h2>
<p><img src="images/Captura%20de%20Pantalla%202022-08-25%20a%20la(s)%2016.16.49.png" /></p>
<p>Durante la primera mitad del año me tocó estar trabajando con infografías en Word (y PPTX) acerca de un proyecto del cual no puedo hablar porque todavía no se publica. En un punto, en el equipo llegamos a tener 512 archivos de word y un día resultó que <strong>teníamos que convertirlos todos a PDF</strong>. Para agravar las cosas, yo <strong>había estado trabajando en Power Point</strong>, y también teníamos que hacer la conversión.</p>
<p>El método tradicional para convertir archivos de office a PDF es utilizando la función de <em>Guardar como…</em> que ya viene en Word, o el <em>Exportar</em> de Power Point. Esta es la opción directa. Sin embargo… yo tenía que hacer esto 512 veces, lo cual lo hacía que el proceso fuese bastante tardado.</p>
<p>Quizá, si le mueves al R, sabrás que se puede trabajar con <em>documentos parametrizados</em>; esto es, documentos que cambian dependiendo de una base de datos. Sin embargo, como en el equipo se decidió que sería más práctico hacerlo en Word (porque generalmente, en un equipo de trabajo, no todos usan <strong>R</strong>, además de que Word es prácticamente un estándar de trabajo en las oficinas de todo el mundo, y quedaron más bonitos que lo que hubiese podido hacer).</p>
<p>Entonces, <strong>aprovechando mis conocimientos de programación y buscando una manera de automatizar el proceso</strong> encontré una forma de realizar esta transformación utilizando código de R, para el caso en el cual tengas que transformar miles y miles de Words a PDF.</p>
<p>Para que el código funcione se requiere lo siguiente:</p>
<ol style="list-style-type: decimal">
<li><p><strong>R instalado</strong> (y RStudio).</p></li>
<li><p>Para que me funcionara a mí en mi Mac Pro M1 (2020), instalé una versión de <em>LibreOffice</em>; programa Open-Source de ofimática (el que generalmente viene para Línux). Si bien para Windows vi que existían métodos alternativos, creo que esta solución debería funcionar en una mayor cantidad de casos.</p></li>
</ol>
<p><img src="images/Captura%20de%20Pantalla%202022-08-25%20a%20la(s)%2014.38.56.png" /></p>
<p><b style = 'color:gray;text-align:center;'>Instalación de LibreOffice</b></p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Documentos a transformar.</strong></li>
</ol>
<p>Una vez que contamos con estos elementos, el siguiente código nos puede ayudar a la transformación:</p>
</div>
<div id="caso-de-transformación-de-word" class="section level2">
<h2>Caso de Transformación de Word:</h2>
<p>Para la transformación a Word vamos a utilizar el paquete <code>{doconv}</code> (disponible en el CRAN).</p>
<p><img src="images/Captura%20de%20Pantalla%202022-08-25%20a%20la(s)%2016.18.56.png" /></p>
<pre class="r"><code># Guardado automático en pdf:

# Librerias ----
library(doconv)    # Convertir a PDF
library(tidyverse) # Manejo de datos

# Carpeta de archivos WORD (donde tengo mis archivos) ----
# Cambiar a la ubicación de tu carpeta: 
origen &lt;- &quot;/Users/juvenalcampos/Downloads/Origen&quot;

# Carpeta para depositar archivos PDF
# Crear una carpeta nueva si se requiere.
destino &lt;- &quot;/Users/juvenalcampos/Downloads/Destino&quot;

# Proceso ----

# 1. Guardamos los archivos. 
archivos &lt;- list.files(origen) 
direcciones &lt;- str_c(origen, &quot;/&quot;, list.files(origen))

# Aplicamos el bucle de transformación: 
lapply(seq_along(direcciones), function(j){

  # Usamos tryCatch por si algún paso se complica, el proceso no se detenga: 
  tryCatch({

    direccion_archivo &lt;- direcciones[j]
    nombre_archivo &lt;- archivos[j] %&gt;%
      str_replace(pattern = &quot;.docx&quot;, replacement = &quot;.pdf&quot;)

    # Transformación: 
    docx2pdf(input =
               direccion_archivo,
             output =
               str_c(destino, &quot;/&quot;, nombre_archivo))

    print(str_c(nombre_archivo))
  },
  
  # Imprimimos los errores, para ver donde ocurrió el problema: 
  error = function(e){print(str_c(&quot;Error en j = &quot;, nombre_archivo))})
})</code></pre>
</div>
<div id="caso-del-power-point" class="section level2">
<h2>Caso del Power Point:</h2>
<p><img src="images/Captura%20de%20Pantalla%202022-08-25%20a%20la(s)%2016.18.44.png" /></p>
<p>En este caso, me funcionó la librería <code>{docxtractr}</code> para realizar un proceso similar, solo que ahora con archivos de Power Point.</p>
<pre class="r"><code># Librerias:
library(tidyverse)
library(docxtractr)

# Carpeta de origen de los archivos: [CAMBIAR]: 
origen &lt;- &quot;/Users/juvenalcampos/Downloads/Origen&quot;

# Carpeta para depositar archivos PDF
# Crear una carpeta nueva si se requiere.
destino &lt;- &quot;/Users/juvenalcampos/Downloads/Destino&quot;

# Archivos: 
archivos &lt;- list.files(root, 
                       full.names = TRUE, 
                       pattern = &quot;.pptx&quot;)

# Bucle de transformación: 
lapply(seq_along(archivos), function(i){
  
  tryCatch({
  convert_to_pdf(path = archivos[i],
                 pdf_file = str_c(destino, &quot;/&quot;, 
                                  archivos[i] %&gt;%
                                    str_remove(pattern = &quot;.pptx&quot;),
                                  &quot;.pdf&quot;))
  print(i)},
  
  # Imprimimos los errores, para ver donde ocurrió el problema: 
  error = function(e){print(str_c(&quot;Error en = &quot;, archivos[i]))})
  
})</code></pre>
<div id="observaciones" class="section level3">
<h3>Observaciones:</h3>
<p>Checa que el documento <strong>no</strong> tenga el <em>Control de cambios</em> activado, o el pdf se va a generar con comentarios incluídos.</p>
</div>
<div id="lógica-del-proceso" class="section level3">
<h3>Lógica del proceso:</h3>
<p>La lógica del proceso (o al menos como yo la entendí) consiste en que R ejecuta una acción que le manda el archivo de Word a <strong>LibreOffice</strong> con la orden de transformarlo a PDF. La transformación <strong>no</strong> se hace en R, solo se gestiona el bucle de envíos al programa que <strong>sí</strong> lo hace.</p>
<p>Espero que este proceso les sirva a aquellas personas que se vean en una situación similar; siempre que se pueda automatizar algún proceso tedioso en la oficina ( <em>entendido por mí como algo que hacemos igual por más de tres veces con audífonos puestos</em>) hay que tratar de ver si se puede automatizar.</p>
<p>Cualquier duda u observación, mandarla a mi correo <code>juvenalcampos.publicaciones@gmail.com</code> o dejar el comentario en la parte de abajo:</p>
</div>
</div>

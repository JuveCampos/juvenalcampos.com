"0","# Descarga de los datos."
"0","library(curl)"
"0","library(readxl)"
"0","library(tidyverse)"
"0","curl::curl_download(url = ""https://www.inegi.org.mx/contenidos/programas/intercensal/2015/tabulados/01_poblacion_mor.xls"", destfile = ""mor_pop.xls"")"
"0",""
"0","# Leemos datos"
"0","# Por tamaño de localidad"
"0","mor <- read_xls(""mor_pop.xls"", sheet = 2, skip = 6)"
"0",""
"0","# Procesado de los datos"
"0","pop <- mor %>%"
"0","  # Filtramos los renglones vacios,"
"0","  # los renglones donde el Tamaño de localidad` es el Total y"
"0","  # los `Grupos quinquenales de edad` son todos ""Total""    "
"0","  filter(!is.na(Estimador) &"
"0","           Estimador == ""Valor"" &"
"0","           `Tamaño de localidad` == ""Total"" &"
"0","           `Grupos quinquenales de edad` != ""Total"") %>%"
"0","  mutate(totH = sum(Hombres),"
"0","         totM = sum(Mujeres)) %>%"
"0","  mutate(Hombres = (Hombres/totH)*100,"
"0","         Mujeres = (Mujeres/totM)*100"
"0","  ) %>%"
"0","  select(-totH, -totM) %>%"
"0","  # Hacemos pivot longer rotando las columnas hombres y mujeres    "
"0","  pivot_longer(cols = c(""Hombres"", ""Mujeres""),"
"0","               names_to = ""Sexo"","
"0","               values_to = ""Poblacion por Sexo"") %>%"
"0","  # Nos quedamos con columnas utiles  "
"0","  select(`Entidad federativa`, `Grupos quinquenales de edad`,"
"0","         `Población total`, Sexo, `Poblacion por Sexo`) %>%"
"0","  filter(!(`Grupos quinquenales de edad` %in% c(""75 años y más"",""No especificado"")))"
"0",""
"0",""
"0","# Elaboracion de la grafica"
"0","ggplot(pop, aes(x = `Grupos quinquenales de edad`,"
"0","                y = `Poblacion por Sexo`,"
"0","                fill = Sexo)) +"
"0","  geom_bar(data = subset(pop, Sexo == ""Hombres"") %>% mutate(`Poblacion por Sexo` = -`Poblacion por Sexo`),"
"0","           stat = ""identity"", width = 0.5, fill = ""blue"") +"
"0","  geom_bar(data = subset(pop, Sexo == ""Mujeres""),"
"0","           stat = ""identity"", width = 0.5, fill = ""pink"") +"
"0","  coord_flip() +"
"0","  ggthemes::theme_tufte() +"
"0","  theme(plot.title = element_text(family = ""Arial"", hjust = 0.5, size = 20),"
"0","        axis.text.x = element_text(family = ""Arial""),"
"0","        axis.text.y = element_text(family = ""Arial"")"
"0","  ) +"
"0","  labs(title = ""Pirámide Poblacional de Morelos, 2015"","
"0","       x = """","
"0","       y = ""Hombres                        Mujeres"","
"0","       caption = ""Fuente: INEGI. Encuesta intercensal 2015. Tabulados de Población \nSe omiten personas de 75 años y más, por venir aglomeradas en un mismo grupo de edad."") +"
"0","  scale_y_continuous(breaks = seq(-12, 12, by = 2), labels = paste0(c(seq(-12, 0, by = 2)*-1, seq(2, 12, by = 2)), ""%""))"
